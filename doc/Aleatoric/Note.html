<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../custom.css" type="text/css" charset="utf-8" />
<link rel="stylesheet" href="../syntax_highlight.css" type="text/css" charset="utf-8" />

    <script src="../jquery.js" type="text/javascript" charset="utf-8"></script>
    <script src="../app.js" type="text/javascript" charset="utf-8"></script>
    <title>Class: Aleatoric::Note</title>
  </head>
  <body>
    <div id="content">
      <div class="section class Aleatoric_Note">
  <h1 class="title">Class: Aleatoric::Note</h1>
  <div class="section docstring">
  <p>
Models a musical note. Current implementation supports CSound. Future
implementation will also support MIDI. Two key ideas are used here. First
is that the class doesn&#8217;t actually specify note properties (which
include commone core ones by convention in CSound but can be arbitrary, and
which in MIDI must include a core set but also can include several optional
ones). Instead it relies on method missing to set properties as they are
created by the Composer script. Second the client can set the format with a
symbol arg in #initialize, which then forces #to_s to output either CSound
or MIDI output. Note also that properties are output by #to_s in the order
they are added to the object. Format is class-scope, meaning that all Notes
in one execution of a Composer score are of the same format.
</p>

</div><div class="section attributes">
  <h1>Attributes</h1>

  
    <div class="instance">
      <h2>Instance Attributes</h2>
      <table>
      
        
        <tr class="">
          <th class='signature'>
            <span class='name'>name</span>
          </td>
          <td class="readwrite">
            [<span id='name-instance_method'>R</span><span id='name=-instance_method'>W</span>] 
          </td>
          <td class="visibility">
            public
          </td>
          <td class="docstring">
            <p>
Sets the attribute <tt>name</tt>.
</p>

            
          </td>
        </tr>
        
      
      </table>
    </div>
  
</div>
<div class="section constants">
  
</div><div class="section constructor">
<h1>Constructor Summary</h1>
  <div id="initialize-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>initialize</span><span class='args'>(name = nil, attrs = nil, format = nil)</span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


17
18
19
20
21
22
23
24
25
26</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/note.rb', line 17</span>

<span class='def def kw'>def</span> <span class='initialize identifier id'>initialize</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='attrs identifier id'>attrs</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='comma token'>,</span> <span class='format identifier id'>format</span><span class='assign token'>=</span><span class='nil nil kw'>nil</span><span class='rparen token'>)</span>
  <span class='@name ivar id'>@name</span> <span class='assign token'>=</span> <span class='name identifier id'>name</span>
  <span class='@note_attrs ivar id'>@note_attrs</span> <span class='assign token'>=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='@ordered_keys ivar id'>@ordered_keys</span> <span class='assign token'>=</span> <span class='lbrack token'>[</span><span class='symbol val'>:instrument</span><span class='comma token'>,</span> <span class='symbol val'>:start</span><span class='comma token'>,</span> <span class='symbol val'>:duration</span><span class='comma token'>,</span> <span class='symbol val'>:amplitude</span><span class='comma token'>,</span> <span class='symbol val'>:pitch</span><span class='rbrack token'>]</span>
  <span class='comment val'># Default formatter is csound. :midi formatter will eventually be supported also</span>
  <span class='format identifier id'>format</span> <span class='opasgn op'>||=</span> <span class='symbol val'>:csound</span>
  <span class='@@format ivar id'>@@format</span> <span class='assign token'>=</span> <span class='format identifier id'>format</span>
  <span class='attrs identifier id'>attrs</span> <span class='opasgn op'>||=</span> <span class='lbrace token'>{</span><span class='rbrace token'>}</span>
  <span class='attrs identifier id'>attrs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='bitor op'>|</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='method_missing identifier id'>method_missing</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='rparen token'>)</span><span class='rbrace token'>}</span>  
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div><div class="section methodmissing">
  <h1>Dynamic Method Handling</h1>

  <p class="note">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
  </p>

  <div id="method_missing-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>method_missing</span><span class='args'>(name, val)</span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Creates accessors for newly created attributes of the object
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


74
75
76
77
78</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/note.rb', line 74</span>

<span class='def def kw'>def</span> <span class='method_missing identifier id'>method_missing</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='rparen token'>)</span>
  <span class='@note_attrs ivar id'>@note_attrs</span><span class='lbrack token'>[</span><span class='name identifier id'>name</span><span class='rbrack token'>]</span> <span class='assign token'>=</span> <span class='val identifier id'>val</span>
  <span class='@ordered_keys ivar id'>@ordered_keys</span> <span class='lshft op'>&lt;&lt;</span> <span class='name identifier id'>name</span> <span class='unless unless_mod kw'>unless</span> <span class='@ordered_keys ivar id'>@ordered_keys</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='name identifier id'>name</span>
  <span class='def_accessor identifier id'>def_accessor</span> <span class='name identifier id'>name</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
</div>  <div class="section visibilitygroup public">
    <h1>Public Visibility</h1>
      <div class="section methodsummary class public">
    <h1>Public Class Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#to_s_format-class_method" title="to_s_format">to_s_format</a></span><span class='args'></span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        
        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#to_s_format%3D-class_method" title="to_s_format=">to_s_format=</a></span><span class='args'>(format)</span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Set to_s appropriately based on output format Adds a to_s definition to the
class based on format value passed to class method.
</p>

        
      </td>
    </tr>
  
</table>

  </div>
  <div class="section methodsummary instance public">
    <h1>Public Instance Method Summary</h1>
<table class="summary">
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#dup-instance_method" title="#dup">#dup</a></span><span class='args'></span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Returns a deep copy of the object.
</p>

        
      </td>
    </tr>
  
    <tr>
      <th class="signature">
        
          <span class='overload'>
            <span class='name'><a href="#to_s-instance_method" title="#to_s">#to_s</a></span><span class='args'></span>
            <span class='block'></span>
          </span>
        
        
      </th>
      <td class="docstring">
        <p>
Outputs a string representation of the note, based on the value for format
passed to #initialize.
</p>

        
      </td>
    </tr>
  
</table>

  </div>
<div class="section methoddetails class public">
  <h1>Public Class Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>to_s_format</h3>
</div><div id="to_s_format-class_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>to_s_format</span><span class='args'></span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


41
42
43</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/note.rb', line 41</span>

<span class='def def kw'>def</span> <span class='Note constant id'>Note</span><span class='dot token'>.</span><span class='to_s_format identifier id'>to_s_format</span>
  <span class='@@format ivar id'>@@format</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_s_format=</h3>
</div><div id="to_s_format=-class_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>to_s_format=</span><span class='args'>(format)</span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Set to_s appropriately based on output format Adds a to_s definition to the
class based on format value passed to class method
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


38
39
40</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/note.rb', line 38</span>

<span class='def def kw'>def</span> <span class='Note constant id'>Note</span><span class='dot token'>.</span><span class='to_s_format identifier id'>to_s_format</span><span class='assign token'>=</span><span class='lparen token'>(</span><span class='format identifier id'>format</span><span class='rparen token'>)</span>
  <span class='@@format ivar id'>@@format</span> <span class='assign token'>=</span> <span class='format identifier id'>format</span><span class='dot token'>.</span><span class='to_sym identifier id'>to_sym</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div><div class="section methoddetails instance public">
  <h1>Public Instance Method Details</h1>
  
    <div class="method">
      <div class="method_header">
  <h3>dup</h3>
</div><div id="dup-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>dup</span><span class='args'></span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Returns a deep copy of the object
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


29
30
31
32
33
34</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/note.rb', line 29</span>

<span class='def def kw'>def</span> <span class='dup identifier id'>dup</span>
  <span class='ret identifier id'>ret</span> <span class='assign token'>=</span> <span class='Note constant id'>Note</span><span class='dot token'>.</span><span class='new identifier id'>new</span>
  <span class='ret identifier id'>ret</span><span class='dot token'>.</span><span class='name identifier id'>name</span> <span class='assign token'>=</span> <span class='self self kw'>self</span><span class='dot token'>.</span><span class='name identifier id'>name</span>
  <span class='@note_attrs ivar id'>@note_attrs</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='lbrace token'>{</span><span class='bitor op'>|</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='bitor op'>|</span> <span class='ret identifier id'>ret</span><span class='dot token'>.</span><span class='method_missing identifier id'>method_missing</span><span class='lparen token'>(</span><span class='name identifier id'>name</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='rparen token'>)</span><span class='rbrace token'>}</span>
  <span class='ret identifier id'>ret</span>
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
    <div class="method">
      <div class="method_header">
  <h3>to_s</h3>
</div><div id="to_s-instance_method" class="section method">
  <div class="details_title">
    <div class='section methodsignature'>
    <tt class='def'>
      <span class='visibility'>public</span>
      <span class='return_types'></span>
      <span class='name'>to_s</span><span class='args'></span>
      <span class='block'></span>
    </tt>
  </div>

</div><div class="section docstring">
  <p>
Outputs a string representation of the note, based on the value for format
passed to #initialize
</p>

</div><div class="section source">
  <span>[<a class="source_link" href="#">View source</a>]</span>
  <div class="source_code">
    <table>
      <tr>
        <td>
          <pre class="lines">


46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71</pre>
        </td>
        <td>
          <pre class="code"><span class="info file"># File 'lib/note.rb', line 46</span>

<span class='def def kw'>def</span> <span class='to_s identifier id'>to_s</span>
  <span class='case case kw'>case</span> <span class='@@format ivar id'>@@format</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:csound</span>
    <span class='ret identifier id'>ret</span> <span class='assign token'>=</span> <span class='string val'>&quot;i &quot;</span>
    <span class='@ordered_keys ivar id'>@ordered_keys</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='bitor op'>|</span>
      <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='@note_attrs ivar id'>@note_attrs</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span> 
      <span class='comment val'># NOTE: This is a pretty terrible check for a float</span>
      <span class='if if kw'>if</span> <span class='val identifier id'>val</span><span class='dot token'>.</span><span class='include? fid id'>include?</span> <span class='string val'>'.'</span>
        <span class='ret identifier id'>ret</span><span class='dot token'>.</span><span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='sprintf identifier id'>sprintf</span><span class='lparen token'>(</span><span class='string val'>&quot;%.5f&quot;</span><span class='comma token'>,</span> <span class='val identifier id'>val</span><span class='rparen token'>)</span> <span class='plus op'>+</span> <span class='string val'>&quot; &quot;</span><span class='rparen token'>)</span>
      <span class='else else kw'>else</span>
        <span class='ret identifier id'>ret</span><span class='dot token'>.</span><span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{val} &quot;</span><span class='rparen token'>)</span>
      <span class='end end kw'>end</span>   
    <span class='end end kw'>end</span>          
    <span class='ret identifier id'>ret</span><span class='dot token'>.</span><span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='dstring node'>&quot;; #{@name}&quot;</span><span class='rparen token'>)</span>          
    <span class='ret identifier id'>ret</span>
  <span class='comment val'># TODO Actually support MIDI</span>
  <span class='when when kw'>when</span> <span class='symbol val'>:midi</span>
    <span class='ret identifier id'>ret</span> <span class='assign token'>=</span> <span class='string val'>&quot;&quot;</span>
    <span class='@ordered_keys ivar id'>@ordered_keys</span><span class='dot token'>.</span><span class='each identifier id'>each</span> <span class='do do kw'>do</span> <span class='bitor op'>|</span><span class='key identifier id'>key</span><span class='bitor op'>|</span>
      <span class='val identifier id'>val</span> <span class='assign token'>=</span> <span class='@note_attrs ivar id'>@note_attrs</span><span class='lbrack token'>[</span><span class='key identifier id'>key</span><span class='rbrack token'>]</span><span class='dot token'>.</span><span class='to_s identifier id'>to_s</span><span class='dot token'>.</span><span class='strip identifier id'>strip</span> 
      <span class='ret identifier id'>ret</span><span class='dot token'>.</span><span class='concat identifier id'>concat</span><span class='lparen token'>(</span><span class='dstring node'>&quot;#{val} &quot;</span><span class='rparen token'>)</span>
    <span class='end end kw'>end</span>
    <span class='ret identifier id'>ret</span>
  <span class='end end kw'>end</span>
  
<span class='end end kw'>end</span>
</pre>
        </td>
      </tr>
    </table>
  </div>
</div>
</div>
    </div>
  
</div>
  </div>

</div>
    </div>
    <div id="yard_info">
  Generated on Friday, August 14 2009 at  by 
  <abbr class="yard" title="Yay! A Ruby Documentation Tool"><a href="http://yard.soen.ca">YARD</a></abbr> 
  0.2.3.3 (ruby-1.8.6).
</div>

  </body>
</html>